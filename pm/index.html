<!DOCTYPE html>
<html>
<head>
  <title>Password Manager</title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="style.css" />
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  <script src="passwordManager.js"></script>
</head>
<body>
  <div id="notices">

  </div>
  <div class="main">
    <div class="controls">
      <form>
        <input type="text" id="username" placeholder="username"/>
        <input type="text" id="website" placeholder=""/>
        <input type="submit" id="generate" value="Generate">
      </form>
    </div>
    <div class="result">
      <p id="result">

      </p>
    </div>
  </div>
  <script>
    sendDanger('<b>PLEASE DO NOT USE THIS AS YOUR PASSWORD MANAGER</b> UNTIL IT HAS GONE THROUGH SOME TESTING, FOLLOW <a href="https://twitter.com/codingneko">@CodingNeko</a> ON TWITTER FOR UPDATES. Always use two factor authentication when using passwords that are stored somewhere!');

    if(getCookie("identifier") == ""){
      sendWarning("Please sign in to start generating passwords <br /> reminder: your password will not be verified against a database, so make sure you get it right first try! <br /><br /> new around here? registering is not needed, just choose a password and a username and you're set! actually, choosing a username is NOT required, but it WILL improve the security of your generated passwords immensely, so it is greatly recommended.")
      document.getElementById("website").type = "password";
      document.getElementById("website").placeholder = "password";
    }else{
      sendWarning("Enter a username and a website to generate your password");
      document.getElementById("website").placeholder = "website";
      document.getElementById("website").type = "text";
    }

    document.getElementById("generate").onclick = function(event){

      event.preventDefault();

      var username = document.getElementById("username").value;
      var website = document.getElementById("website").value;

      if(getCookie("identifier") == ""){
        var identifier = generateIdentifier(username, website);

        if (identifier != 1){
            setCookie("identifier", identifier, 365);
            sendSuccess("Nice, you're now logged in, enter a username and a website to generate your password");
            document.getElementById("website").value = "";
            document.getElementById("website").type = "text";
            document.getElementById("website").placeholder = "website";
        }else{
          sendDanger("you must use a password with at least 8 characters");
        }

      }else if(getCookie("identifier").length == 32){
        document.getElementById("result").innerHTML = "Generated password: " + generatePassword(username, website);
      }

    }
  </script>
</body>
</html>
